var smallarray: int8[200];
var largearray: int8[512];
var ptr: [int8] := &largearray[0];
var smallu: uint8 := 0;
var smalls: int8 := 1;
var largeu: uint16 := 300;
var larges: int16 := 301;
var maxuint8: uint8 := 0xff;

sub yes() print(": yes\r"); end sub;
sub no() print(": no\r"); end sub;

sub zero_memory(ptr: [int8], size: uint16)
    while size != 0 loop
        size := size - 1;
        ptr[size as int16] := 0;
    end loop;
end sub;
zero_memory(&smallarray[0] as [int8], smallarray@bytes);
zero_memory(&largearray[0] as [int8], largearray@bytes);

# [array + numoff]. We expect these to work, they're just simple absolute references.
smallarray[0] := 0x55;
smallarray[1] := 0xAA;
largearray[0] := 0x55;
largearray[1] := 0xAA;
largearray[300] := 0x55;
largearray[301] := 0xAA;

# [array + varoff].
print("smallarray[smallu]==0x55"); if smallarray[smallu] == 0x55 then yes(); else no(); end if;
print("largearray[largeu]==0x55"); if largearray[largeu] == 0x55 then yes(); else no(); end if;

# [array + numoff + varoff].
print("smallarray[smallu+1]==0xAA"); if smallarray[smallu+1] == 0xAA then yes(); else no(); end if;
print("largearray[largeu+1]==0xAA"); if largearray[largeu+1] == 0xAA then yes(); else no(); end if;

# [ptr + numoff].
print("ptr[0]==0x55"); if ptr[0] == 0x55 then yes(); else no(); end if;
print("ptr[1]==0xAA"); if ptr[1] == 0xAA then yes(); else no(); end if;
print("ptr[300]==0x55"); if ptr[300] == 0x55 then yes(); else no(); end if;
print("ptr[301]==0xAA"); if ptr[301] == 0xAA then yes(); else no(); end if;

# [ptr + varoff].
print("ptr[larges]==0xAA"); if ptr[larges as int16] == 0xAA then yes(); else no(); end if;

# [ptr + numoff + varoff].
print("ptr[larges-1]==0x55"); if ptr[larges-1] == 0x55 then yes(); else no(); end if;
